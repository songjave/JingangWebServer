webpackJsonp([22],{1009:function(t,e,a){a(1202);var r=a(377)(a(1114),a(1174),"data-v-10041d15",null);t.exports=r.exports},1033:function(t,e){!function(t){t.URL=t.URL||t.webkitURL,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var e=function(e,a){a=a||{},a.sampleBits=a.sampleBits||16,a.sampleRate=a.sampleRate||14700;var r=new(t.webkitAudioContext||t.AudioContext),i=r.createMediaStreamSource(e),n=r.createScriptProcessor||r.createJavaScriptNode,s=n.apply(r,[4096,1,1]),o={size:0,buffer:[],inputSampleRate:r.sampleRate,inputSampleBits:16,outputSampleRate:a.sampleRate,oututSampleBits:a.sampleBits,clear:function(){this.buffer=[],this.size=0},input:function(t){this.buffer.push(new Float32Array(t)),this.size+=t.length},compress:function(){for(var t=new Float32Array(this.size),e=0,a=0;a<this.buffer.length;a++)t.set(this.buffer[a],e),e+=this.buffer[a].length;for(var r=parseInt(this.inputSampleRate/this.outputSampleRate),i=t.length/r,n=new Float32Array(i),s=0,o=0;s<i;)n[s]=t[o],o+=r,s++;return n},encodeWAV:function(){var t=Math.min(this.inputSampleRate,this.outputSampleRate),e=Math.min(this.inputSampleBits,this.oututSampleBits),a=this.compress(),r=a.length*(e/8),i=new ArrayBuffer(44+r),n=new DataView(i),s=0,o=function(t){for(var e=0;e<t.length;e++)n.setUint8(s+e,t.charCodeAt(e))};if(o("RIFF"),s+=4,n.setUint32(s,36+r,!0),s+=4,o("WAVE"),s+=4,o("fmt "),s+=4,n.setUint32(s,16,!0),s+=4,n.setUint16(s,1,!0),s+=2,n.setUint16(s,1,!0),s+=2,n.setUint32(s,t,!0),s+=4,n.setUint32(s,1*t*(e/8),!0),s+=4,n.setUint16(s,e/8*1,!0),s+=2,n.setUint16(s,e,!0),s+=2,o("data"),s+=4,n.setUint32(s,r,!0),s+=4,8===e)for(var c=0;c<a.length;c++,s++){var u=Math.max(-1,Math.min(1,a[c])),l=u<0?32768*u:32767*u;l=parseInt(255/(65535/(l+32768))),n.setInt8(s,l,!0)}else for(var c=0;c<a.length;c++,s+=2){var u=Math.max(-1,Math.min(1,a[c]));n.setInt16(s,u<0?32768*u:32767*u,!0)}return new Blob([n],{type:"audio/wav"})}};this.start=function(){i.connect(s),s.connect(r.destination)},this.stop=function(){s.disconnect()},this.clear=function(){o.clear()},this.getBlob=function(){return this.stop(),o.encodeWAV()},this.play=function(e){e.src=t.URL.createObjectURL(this.getBlob())},this.getData=function(){return this.getBlob()},s.onaudioprocess=function(t){o.input(t.inputBuffer.getChannelData(0))}};e.throwError=function(t){},e.canRecording=null!=navigator.getUserMedia,e.get=function(t,a){if(t){if(!navigator.getUserMedia)return t({name:"UNSUPPORTED_Error",msg:"当前浏览器不支持录音功能"});navigator.getUserMedia({audio:!0},function(r){var i=new e(r,a);t(i)},function(e){switch(e.code||e.name){case"PERMISSION_DENIED":case"PermissionDeniedError":e.msg="浏览器拒绝开启录音功能",t(e);break;case"NOT_SUPPORTED_ERROR":case"NotSupportedError":e.msg="浏览器不支持硬件设备",t(e);break;case"MANDATORY_UNSATISFIED_ERROR":case"MandatoryUnsatisfiedError":e.msg="无法发现指定的硬件设备",t(e);break;default:e.msg="无法打开麦克风",t(e)}})}},t.HZRecorder=e}(window)},1114:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a(1033);a.n(r);e.default={components:{},data:function(){return{url:"/api/func/stt",urlBeta:"/api/func/stt/stt_beta",urlAlpha:"/api/func/stt/stt_alpha",urlBaidu:"/api/func/stt/stt_baidu_online",isRecording:!1,recorder:null,voiceBlob:null,text:"暂无识别结果",textBeta:"暂无识别结果",textAlpha:"暂无识别结果",textBaidu:"暂无识别结果",form:{}}},created:function(){},computed:{},methods:{doRecoginze:function(){var t=this,e=new FormData;e.append("file",this.voiceBlob),this.$axios.post(this.url,e).then(function(e){var a=e.data;if(a.errCode)return t.text=a.errMsg||a.errCode;t.text=a.data.text||"未识别到文本"}),this.$axios.post(this.urlBeta,e).then(function(e){var a=e.data;if(a.errCode)return t.textBeta=a.errMsg||a.errCode;t.textBeta=a.data.text||"未识别到文本"}),this.$axios.post(this.urlAlpha,e).then(function(e){var a=e.data;if(a.errCode)return t.textAlpha=a.errMsg||a.errCode;t.textAlpha=a.data.text||"未识别到文本"}),this.$axios.post(this.urlBaidu,e).then(function(e){var a=e.data;if(a.errCode)return t.textBaidu=a.errMsg||a.errCode;t.textBaidu=a.data.text||"未识别到文本"})},onStartRecord:function(){var t=this;this.isRecording&&this.recorder.stop(),this.recorder?(this.recorder.clear(),this.isRecording=!0,this.recorder.start()):this.recorder&&window.AudioContext||HZRecorder.get(function(e){if(console.log(e),e.code||e.name)return t.$message.error(e.msg);t.recorder=e,t.isRecording=!0,t.recorder.start()})},onStopRecord:function(){this.recorder.stop();var t=document.getElementById("audio");this.recorder.play(t),this.voiceBlob=this.recorder.getData(),this.isRecording=!1},onRecoginze:function(){if(!this.voiceBlob)return alert("无效数据");this.doRecoginze()}}}},1121:function(t,e,a){e=t.exports=a(164)(!1),e.push([t.i,".handle-box[data-v-10041d15]{margin-bottom:20px}.handle-select[data-v-10041d15]{width:120px}.handle-input[data-v-10041d15]{width:300px;display:inline-block}.el-row[data-v-10041d15]{margin-bottom:20px}.stt_tag[data-v-10041d15]{display:block;margin-bottom:10px;width:fit-content}",""])},1174:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"table"},[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-menu"}),t._v(" 服务管理")]),t._v(" "),a("el-breadcrumb-item",[t._v("语音识别测试")])],1)],1),t._v(" "),a("div",{staticClass:"my-box"},[a("el-row",[a("audio",{attrs:{id:"audio",controls:""}})]),t._v(" "),a("el-row",[a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(e){t.onStartRecord()}}},[t._v("开始录音")]),t._v(" "),a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(e){t.onStopRecord()}}},[t._v("停止录音")])],1),t._v(" "),a("el-row",[a("el-button",{attrs:{type:"success"},on:{click:function(e){t.onRecoginze()}}},[t._v("进行语音识别")])],1),t._v(" "),a("el-tag",{staticClass:"stt_tag"},[t._v(t._s(t.text))]),t._v(" "),a("el-tag",{staticClass:"stt_tag",attrs:{type:"primary"}},[t._v(t._s(t.textBeta))]),t._v(" "),a("el-tag",{staticClass:"stt_tag",attrs:{type:"success"}},[t._v(t._s(t.textAlpha))]),t._v(" "),a("el-tag",{staticClass:"stt_tag",attrs:{type:"warning"}},[t._v(t._s(t.textBaidu))])],1)])},staticRenderFns:[]}},1202:function(t,e,a){var r=a(1121);"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);a(378)("65a8ed78",r,!0)}});