webpackJsonp([16],{1012:function(t,e,a){a(1222);var i=a(377)(a(1117),a(1193),"data-v-846ce380",null);t.exports=i.exports},1015:function(t,e,a){t.exports={default:a(1016),__esModule:!0}},1016:function(t,e,a){var i=a(124),o=i.JSON||(i.JSON={stringify:JSON.stringify});t.exports=function(t){return o.stringify.apply(o,arguments)}},1117:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a(1015),o=a.n(i);e.default={components:{},data:function(){return{loadDisplay:!1,imgArr:[],tarImg:"",loadText:"",webUrl:"",videoDesc:"",decsDisplay:!1,date1:"",form:{date:"",location:"",videoName:"",fileId:""},url:"/api/func/video_frame",resultUrl:"/api/func/video_frame",inputUrl:"/api/func/video_frame_webUrl",targetUrl:"/api/func/pic_target_webUrl",infoUrl:"/api/func/video_info"}},created:function(){},computed:{},methods:{initForm:function(){this.date1="",this.form={date:"",location:"",videoName:"",fileId:""}},onWatchFrameReady:function(t){var e=this,a=setInterval(function(){e.$axios.get(e.resultUrl+"/"+t).then(function(i){var o=i.data;if(o.errCode)return clearInterval(a),e.loadText="",e.loadDisplay=!1,e.$message.err("数据处理失败");o.data.summary&&(clearInterval(a),e.postVideoInfo(t),e.initForm(),e.loadText="",e.loadDisplay=!1,e.videoDesc="视频中显示了"+o.data.summary,e.decsDisplay=!0,o.data.images.forEach(function(t,a){e.imgArr.push({img:o.data.dir+o.data.images[a]})}),console.log("请求成功时this.imgArr：",e.imgArr))})},2e3)},postVideoInfo:function(t){var e=this;this.form.fileId=t,this.$axios.post(this.infoUrl,this.form).then(function(t){e.$message.success("信息存储成功")})},postVideo:function(t,e){var a=this;this.$axios.post(t,e).then(function(t){var e=t.data;return e.errCode?(a.loadDisplay=!1,a.loadText="",-4===e.errCode?a.$message.error("输入地址中无可下载的视频"):a.$message.error("处理异常: "+(t.data.errMsg||t.data.errCode))):(a.onWatchFrameReady(e.data.id),a.loadText="信息提取中...")})},onInputVideo:function(t){if(!this.form.date||!this.form.location)return this.$message.error("请输入完整的视频信息");if(t.target.files[0]){this.imgArr=[{img:""}],this.decsDisplay=!1,this.loadDisplay=!0,this.loadText="文件提交中...",this.form.videoName=t.target.files[0].name;var e=new FormData;this.form.date=this.form.date.toLocaleString(),e.append("file",t.target.files[0]),this.postVideo(this.url,e)}},clickVideoBtn:function(){var t=document.getElementById("video-input");t&&t.value&&(t.value=""),document.getElementById("video-input").click()},onWebSubmit:function(){if(!this.form.date||!this.form.location)return this.$message.error("请输入完整的视频信息");var t=this.webUrl.lastIndexOf("."),e=this.webUrl.substr(t+1);if(!/^[hH][tT][tT][pP]([sS]?):\/\/(\S+\.)+\S{2,}$/.test(this.webUrl)||!/mp4/g.test(e))return this.$message.error("视频地址格式错误");this.imgArr=[{img:""}],this.decsDisplay=!1,this.loadDisplay=!0,this.loadText="文件提交中...",console.log(this.webUrl),this.form.videoName=this.webUrl.replace(/(.*\/)*([^.]+)/gi,"$2");var a=new FormData;this.form.date=this.form.date.toLocaleString(),a.append("videoInfo",o()(this.form)),a.append("url",this.webUrl),this.postVideo(this.inputUrl,a)}}}},1141:function(t,e,a){e=t.exports=a(164)(!1),e.push([t.i,'[data-v-846ce380]::-webkit-input-placeholder{color:#97a8be}.vf-frame-box[data-v-846ce380]{position:relative;width:fit-content;display:inline-block}.vf-frame-img[data-v-846ce380]{position:relative;display:inline-block;max-height:300px;width:auto;margin:10px 10px 0 0;box-shadow:0 1px 3px rgba(0,0,0,.39)}#vf-video-input[data-v-846ce380]{width:calc(100% - 93px);margin-bottom:10px;transform:translateY(2px)}.vf-tag[data-v-846ce380]{display:block;width:fit-content;margin-bottom:10px;padding:0 15px;color:#777474;font-size:14px;font-weight:600}.vf-label[data-v-846ce380]{width:50%!important;margin-bottom:12px}.vf-label .el-input[data-v-846ce380]{width:calc(100% - 2px)}.vf-label .el-col-11[data-v-846ce380]{width:calc(50% - 8px)}#short-line[data-v-846ce380]{width:14px}.loader[data-v-846ce380]{position:absolute;width:250px;height:50px;line-height:50px;text-align:center;top:50%;left:50%;transform:translate(-50%,-50%);font-family:helvetica,arial,sans-serif;text-transform:uppercase;font-weight:900;color:#20a0ff;letter-spacing:.2em;z-index:10}.loader[data-v-846ce380]:after,.loader[data-v-846ce380]:before{content:"";display:block;width:15px;height:15px;background:#20a0ff;position:absolute;animation:load .7s infinite alternate ease-in-out}.loader[data-v-846ce380]:before{top:0}.loader[data-v-846ce380]:after{bottom:0}@keyframes load{0%{left:0;height:30px;width:15px}50%{height:8px;width:40px}to{left:235px;height:30px;width:15px}}',""])},1193:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"table"},[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-menu"}),t._v(" 功能")]),t._v(" "),a("el-breadcrumb-item",[t._v("视频信息提取")])],1)],1),t._v(" "),a("el-form",{ref:"form",attrs:{model:t.form,"label-width":"90px"}},[a("el-form-item",{staticClass:"vf-label",attrs:{label:"时间："}},[a("el-col",{attrs:{span:11}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期"},model:{value:t.date1,callback:function(e){t.date1=e},expression:"date1"}})],1),t._v(" "),a("el-col",{staticClass:"line",attrs:{span:2,id:"short-line"}},[t._v("—")]),t._v(" "),a("el-col",{attrs:{span:11}},[a("el-time-picker",{staticStyle:{width:"100%"},attrs:{type:"fixed-time",placeholder:"选择时间"},model:{value:t.form.date,callback:function(e){t.$set(t.form,"date",e)},expression:"form.date"}})],1)],1),t._v(" "),a("el-form-item",{staticClass:"vf-label",attrs:{label:"地点："}},[a("el-input",{model:{value:t.form.location,callback:function(e){t.$set(t.form,"location",e)},expression:"form.location"}})],1),t._v(" "),a("el-form-item",{staticClass:"vf-label",attrs:{label:"本地视频："}},[a("input",{staticStyle:{display:"none"},attrs:{type:"file",accept:"video/mp4",multiple:"multiple",refs:"onInputVideo",id:"video-input"},on:{change:t.onInputVideo}}),t._v(" "),a("el-button",{attrs:{type:"success"},on:{click:t.clickVideoBtn}},[t._v("选择文件并提取")])],1),t._v(" "),a("el-form-item",{staticClass:"vf-label",attrs:{label:"网络视频："}},[a("el-input",{attrs:{placeholder:"输入视频地址，仅支持mp4格式，如：http://www.ailongma.com/video/abc.mp4",icon:"search",id:"vf-video-input"},model:{value:t.webUrl,callback:function(e){t.webUrl=e},expression:"webUrl"}}),t._v(" "),a("el-button",{attrs:{type:"success"},on:{click:t.onWebSubmit}},[t._v("点击提取")])],1)],1),t._v(" "),t.loadDisplay?a("div",{staticClass:"loader"},[t._v(t._s(t.loadText))]):t._e(),t._v(" "),t.decsDisplay?a("el-tag",{staticClass:"vf-tag",attrs:{type:"gray"}},[t._v(t._s(t.videoDesc))]):t._e(),t._v(" "),t._l(t.imgArr,function(e,i){return a("div",{staticClass:"vf-frame-box"},[e.img?a("img",{staticClass:"vf-frame-img",attrs:{src:e.img}}):t._e()])})],2)},staticRenderFns:[]}},1222:function(t,e,a){var i=a(1141);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a(378)("9202f73c",i,!0)}});